(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[852],{60:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g,dynamic:()=>p});var n=a(5155),o=a(2115);let c=null,s=null;async function r(){if(c&&s&&Date.now()<s)return c;let e=await fetch("https://eu-north-1tghnjih8v.auth.eu-north-1.amazoncognito.com/oauth2/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic "+btoa("".concat("3s092bu7p5c5e51j47rtn65jfp",":").concat("1ntsjhst4pkjddsae1oqh6rag66nmbu9uoian7qkdnqqsdedf2b8"))},body:new URLSearchParams({grant_type:"client_credentials"})});if(!e.ok)throw Error("Failed to authenticate with Cognito");let t=await e.json();return c=t.access_token,s=Date.now()+1e3*t.expires_in,c}async function i(){return localStorage.getItem("spotify_access_token")}async function l(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await r(),o=await fetch("".concat("https://st7zxdu7ti.execute-api.eu-north-1.amazonaws.com").concat(e),{...a,headers:{...null!==(t=a.headers)&&void 0!==t?t:{},Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});if(!o.ok)throw Error("API error: ".concat(o.status));return o.json()}async function u(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await i(),o=await fetch("".concat("https://api.spotify.com").concat(e),{...a,headers:{...null!==(t=a.headers)&&void 0!==t?t:{},Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});if(!o.ok)throw Error("API error: ".concat(o.status));return o.json()}async function h(e){return await l("/main/recommend?search=".concat(encodeURIComponent(e)))}async function d(e){return await l("/main/recommend?genre",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("spotify_access_token"))},body:JSON.stringify(e)})}async function m(){return await u("/v1/me/following?type=artist")}var f=a(6658);let p="force-static";function g(){let[e,t]=(0,o.useState)("Metallica"),[a,c]=(0,o.useState)([]),[s,r]=(0,o.useState)(null),[i,l]=(0,o.useState)(!1),u=(0,f.useRouter)();async function p(){try{let e=await m(),t=await d(e);c(t.artists||[]),console.log("Genre Recommendations:",a)}catch(e){r(e instanceof Error?e.message:String(e))}}async function g(){if(console.log("Fetching recommendations..."),p(),e.trim()){l(!0),r(null);try{let t=await h(e);c(t.artists||[])}catch(e){r(e instanceof Error?e.message:String(e))}finally{l(!1)}}}return(0,o.useEffect)(()=>{let e=new URLSearchParams(window.location.hash.substring(1)).get("access_token");e&&!localStorage.getItem("spotify_access_token")&&(localStorage.setItem("spotify_access_token",e),u.replace("/"))},[u]),(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen p-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Music Recommendations"}),(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,n.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),className:"border p-2 w-80",placeholder:"Search for an artist..."}),(0,n.jsx)("button",{onClick:g,className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition",children:"Search"})]}),i&&(0,n.jsx)("p",{className:"mt-4",children:"Loading..."}),s&&(0,n.jsxs)("p",{className:"mt-4 text-red-500",children:["Error: ",s]}),(0,n.jsx)("ul",{className:"list-disc text-left mt-4",children:a.length>0?a.map((e,t)=>(0,n.jsx)("li",{className:"text-lg",children:e},t)):!i&&(0,n.jsx)("p",{children:"No recommendations found."})})]})}},8510:(e,t,a)=>{Promise.resolve().then(a.bind(a,60))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,587,358],()=>t(8510)),_N_E=e.O()}]);