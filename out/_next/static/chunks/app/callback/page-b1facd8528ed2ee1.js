(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[852],{5853:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>x,dynamic:()=>g});var o=n(5155),a=n(2115);let s="https://st7zxdu7ti.execute-api.eu-north-1.amazonaws.com",r=null,c=null;async function l(){if(r&&c&&Date.now()<c)return r;let e=await fetch("https://eu-north-1tghnjih8v.auth.eu-north-1.amazoncognito.com/oauth2/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic "+btoa("".concat("3s092bu7p5c5e51j47rtn65jfp",":").concat("1ntsjhst4pkjddsae1oqh6rag66nmbu9uoian7qkdnqqsdedf2b8"))},body:new URLSearchParams({grant_type:"client_credentials"})});if(!e.ok)throw Error("Failed to authenticate with Cognito");let t=await e.json();return r=t.access_token,c=Date.now()+1e3*t.expires_in,r}async function i(){return localStorage.getItem("spotify_access_token")}async function d(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=await l();console.log("Fetching API:","".concat(s).concat(e)),console.log("Options:",JSON.stringify(n,null,2));let a=await fetch("".concat(s).concat(e),{...n,headers:{...null!==(t=n.headers)&&void 0!==t?t:{},Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}});if(console.log("Raw Response Object:",a),!a||"function"!=typeof a.json)throw console.error("Invalid response format detected:",a),Error("Invalid response format from fetchWithAuth");let r=await a.json();if(console.log("Parsed JSON Data:",r),!a.ok)throw Error("API error: ".concat(a.status," - ").concat(r.message||"Unknown error"));return r}async function m(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=await i(),a=await fetch("".concat("https://api.spotify.com").concat(e),{...n,headers:{...null!==(t=n.headers)&&void 0!==t?t:{},Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}});if(!a.ok)throw Error("API error: ".concat(a.status));return a.json()}async function u(e){return await d("/recommend?search=".concat(encodeURIComponent(e)),{})}async function h(e){try{var t;console.log("Sending Genre Data:",JSON.stringify(e,null,2));let n=await d("/recommend/genre",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("spotify_access_token"))},body:JSON.stringify(e)});return console.log("Final Parsed Data:",n),{matchedGenres:n.matched_genres||[],recommendedArtists:(null===(t=n.recommended_artists)||void 0===t?void 0:t.map(e=>e.name))||[]}}catch(e){return console.error("Error fetching genre recommendations:",e),{matchedGenres:[],recommendedArtists:[]}}}async function f(){return await m("/v1/me/following?type=artist")}var p=n(6046);let g="force-static";function x(){let[e,t]=(0,a.useState)("Metallica"),[n,s]=(0,a.useState)([]),[r,c]=(0,a.useState)([]),[l,i]=(0,a.useState)(null),[d,m]=(0,a.useState)(!1),g=(0,p.useRouter)();async function x(){try{m(!0),i(null);let e=await f();console.log("Unfollowed Artist Data:",e);let t=await h(e),{matchedGenres:n,recommendedArtists:o}=await h(e);console.log("Matched Genres:",n),console.log("Recommended Artists:",o),console.log("Genre Recommendations:",t),o?c(o.slice(0,10)):c([])}catch(e){i(e instanceof Error?e.message:String(e))}finally{m(!1)}}async function w(){if(e.trim()){m(!0),i(null);try{let t=await u(e);s(t.artists||[])}catch(e){i(e instanceof Error?e.message:String(e))}finally{m(!1)}}}return(0,a.useEffect)(()=>{let e=new URLSearchParams(window.location.hash.substring(1)),t=e.get("access_token"),n=e.get("expires_in");if(t&&n){let e=Date.now()+1e3*parseInt(n);localStorage.setItem("spotify_access_token",t),localStorage.setItem("spotify_token_expiration",e.toString()),window.history.replaceState({},document.title,window.location.pathname)}let o=localStorage.getItem("spotify_access_token"),a=localStorage.getItem("spotify_token_expiration");(!o||!a||Date.now()>parseInt(a))&&(localStorage.removeItem("spotify_access_token"),localStorage.removeItem("spotify_token_expiration"),g.replace("/"))},[g]),(0,o.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-center min-h-screen p-8 gap-8",children:[(0,o.jsxs)("div",{className:"w-full md:w-1/2 p-6 flex flex-col items-center",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-4 text-center",children:"Recommendations from Unfollowed Artists"}),(0,o.jsx)("button",{onClick:x,className:"bg-green-500 text-white px-6 py-2 rounded-md hover:bg-green-600 transition",children:"Get me recommendations from artists I donâ€™t follow"}),d&&(0,o.jsx)("p",{className:"mt-4",children:"Loading..."}),l&&(0,o.jsxs)("p",{className:"mt-4 text-red-500",children:["Error: ",l]}),(0,o.jsx)("ul",{className:"list-disc text-left mt-4",children:r.length>0?r.slice(0,10).map((e,t)=>(0,o.jsx)("li",{className:"text-lg",children:e},t)):!d&&(0,o.jsx)("p",{children:"No genre-based recommendations found."})})]}),(0,o.jsx)("div",{className:"w-full md:w-[2px] h-[2px] md:h-full bg-gray-300"}),(0,o.jsxs)("div",{className:"w-full md:w-1/2 p-6 flex flex-col items-center",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-4 text-center",children:"Search for Music Recommendations"}),(0,o.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,o.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),className:"border p-2 w-80",placeholder:"Search for an artist..."}),(0,o.jsx)("button",{onClick:w,className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition",children:"Search"})]}),d&&(0,o.jsx)("p",{className:"mt-4",children:"Loading..."}),l&&(0,o.jsxs)("p",{className:"mt-4 text-red-500",children:["Error: ",l]}),(0,o.jsx)("ul",{className:"list-disc text-left mt-4",children:n.length>0?n.map((e,t)=>(0,o.jsx)("li",{className:"text-lg",children:e},t)):!d&&(0,o.jsx)("p",{children:"No search results found."})})]})]})}},6046:(e,t,n)=>{"use strict";var o=n(6658);n.o(o,"useRouter")&&n.d(t,{useRouter:function(){return o.useRouter}})},8510:(e,t,n)=>{Promise.resolve().then(n.bind(n,5853))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,587,358],()=>t(8510)),_N_E=e.O()}]);